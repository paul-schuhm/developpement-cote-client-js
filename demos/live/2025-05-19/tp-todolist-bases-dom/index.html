<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS DOM/Todo list</title>

    <style>
        .done {
            text-decoration: line-through;
            color: grey;
        }
    </style>
</head>

<body>

    <h1>Manipulation du DOM (Todo list)</h1>


    <h2>A faire</h2>

    <div>
        <input type="text" name="" id="task_label">
        <button id="add_task">Ajouter une tâche</button>
    </div>


    <ul id="tasks">
        <li class="done">
            <label for="task-1">Acheter du pain</label>
            <input type="checkbox" name="" id="task-1" checked>
        </li>
        <li>
            <label for="task-2">Déclarer ses impôts</label>
            <input type="checkbox" name="" id="task-2">
        </li>
    </ul>


    <script>

        //Identifiant unique d'une tache
        let taskId = 0;


        // //1. Selectionner l'élément HTML
        // let checkbox = document.querySelector('input[type="checkbox"]#task-1');
        // //2. Ajouter un écouteur d'évènement ('change')
        // const li = document.querySelector('ul li:first-child');

        // checkbox.addEventListener('change', function (event) {
        //     li.classList.toggle('done')
        // });


        /**
         * Retourne un élément HTML qui représente
         * une tache (composant)
         */
        function createTaskElement(taskLabel, taskId) {
            const li = document.createElement('li');
            const label = document.createElement('label');
            const checkbox = document.createElement('input[type="checkbox"]');
            li.appendChild(label);
            li.appendChild(checkbox);

            checkbox.setAttribute('id', taskId);
            label.textContent = taskLabel;
            label.setAttribute('for', taskId);

            return li;
        }


        function actionAddTask() {

            //Récuperer la liste des tâches
            let tasks = document.getElementById("tasks");
            //Récupérer l'input texte
            let input = document.getElementById("task_label");

            //Créer un élément HTML représentant une tache
            let task = createTaskElement(input.value, taskId);
            //Incrémenter l'identifiant unique attribué à chaque tache
            taskId++;

            //Réinitialiser l'input (vider la saisie)
            input.value = "";
        }


        //Récupère une référence vers un objet qui représente "le noeud" du bouton
        let btnAddTask = document.getElementById("add_task");
        //Enregistrer un écouteur d'évènement (une fonction associée à un évènement)
        //Dès qu'il y aura un click sur le bouton, la fonction sera executée
        btnAddTask.addEventListener('click', actionAddTask);

    </script>

</body>

</html>