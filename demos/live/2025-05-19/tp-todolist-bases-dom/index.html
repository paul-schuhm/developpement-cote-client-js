<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS DOM/Todo list</title>

    <style>
        .done {
            text-decoration: line-through;
            color: grey;
        }
    </style>
</head>

<body>

    <h1>Manipulation du DOM (Todo list)</h1>


    <h2>A faire</h2>

    <div>
        <input type="text" name="" id="task_label">
        <button id="add_task">Ajouter une tâche</button>
    </div>


    <ul id="tasks">
    </ul>


    <script>

        //Identifiant unique d'une tache
        let taskId = 0;
        //Référence vers l'input texte qui donne le nom de la tache à ajouter
        let input = document.getElementById("task_label");
        //Récupère une référence vers un objet qui représente "le noeud" du bouton
        let btnAddTask = document.getElementById("add_task");

        /**
         * Retourne un élément HTML qui représente
         * une tache (composant)
         */
        function createTaskElement(taskLabel, taskId) {
            const li = document.createElement('li');
            const label = document.createElement('label');
            //Créer un input de type checkbox (en 2 temps)
            const checkbox = document.createElement('input');
            checkbox.setAttribute('type', 'checkbox');
            li.appendChild(label);
            li.appendChild(checkbox);

            checkbox.setAttribute('id', taskId);
            label.textContent = taskLabel;
            label.setAttribute('for', taskId);

            //Ajouter un écouteur d'évènement pour rayer la tache quand elle est faite
            checkbox.addEventListener('change', function (event) {
                li.classList.toggle('done')
            });

            //Ajouter un bouton pour supprimer la tache
            const btnDelete = document.createElement('button');
            btnDelete.innerText = "Supprimer";

            return li;
        }


        function actionAddTask() {

            //Si l'input est vide, on n'ajoute pas de tache à la liste
            if (!input.value)
                return;

            //Récuperer la liste des tâches
            let tasks = document.getElementById("tasks");

            //Créer un élément HTML représentant une tache
            let task = createTaskElement(input.value, taskId);
            //Incrémenter l'identifiant unique attribué à chaque tache
            taskId++;

            //Insérer la tache dans la liste
            tasks.appendChild(task);

            //Réinitialiser l'input (vider la saisie)
            input.value = "";
        }

        //Enregistrer un écouteur d'évènement (une fonction associée à un évènement)
        //Dès qu'il y aura un click sur le bouton, la fonction sera executée
        btnAddTask.addEventListener('click', actionAddTask);

    </script>

</body>

</html>